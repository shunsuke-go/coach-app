 var comment_error = document.getElementById('comment_error');
 var article_page = document.getElementById('article_page');
 var comments = document.getElementById('comments');
 var comment_content = document.getElementById('comment_content');
fetch("/api/v1/articles/<%=@article.id%>/comments",
{ 
  mode: 'cors',
  method: 'GET',
  headers: {
    Authorization: "Token <%= current_user.token %>",
    "Content-Type": "application/json"
  }
}).then(response =>response.json())
.then(data => {
  
  var new_comment = data[data.length-1]
  var hidden = (<%= current_user.id %> != new_comment.user.id) ? "hidden":""
  var img = (new_comment.user.avatar != null) ? new_comment.user.avatar:"/assets/no-image.jpg"
  
  comments.insertAdjacentHTML('beforeend',`
  <li id='comment_${new_comment.id}'　class='comment-${new_comment.id} margin-20'>
    <div class="margin-20">  
      <a href="/users/${new_comment.user.id}">
        <img class="circle small" src=${img}>
      </a>
      <span class="profile-link">
        <a href="/users/${new_comment.user.id}">
          ${new_comment.user.name}
        </a>
      </span>
      <div class="comment">
        ${new_comment.content}
      </div>
      <div class="divider"></div>
      <div class="right comment-delete">
        <a data-confirm="本当に削除しますか？" data-remote="true" rel="nofollow"
        data-method="delete" href="/articles/${new_comment.article.id}/comments/${new_comment.id}"
        ${hidden}>削除</a>  
      </div>
    </div>
  </li>`)
}).catch(e => {
  console.log(e);
})





comment_error.textContent='';
comment_content.value='';